window.Subjx=function(r){var n={};function o(t){if(n[t])return n[t].exports;var e=n[t]={i:t,l:!1,exports:{}};return r[t].call(e.exports,e,e.exports,o),e.l=!0,e.exports}return o.m=r,o.c=n,o.d=function(t,e,r){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(r,n,function(t){return e[t]}.bind(null,n));return r},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=1)}([function(t,e,r){},function(t,e,r){"use strict";r.r(e);r(0);var N=requestAnimationFrame||mozRequestAnimationFrame||webkitRequestAnimationFrame||msRequestAnimationFrame||function(t){return setTimeout(t,1e3/60)},n=cancelAnimationFrame||mozCancelAnimationFrame||function(t){clearTimeout(t)},o=(Array.prototype.forEach,Array.prototype.slice),i=Array.prototype.map,a=console.warn;function f(t){return null!=t}function P(t){return null==t}function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var c=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.observers={}}return function(t,e,r){e&&s(t.prototype,e),r&&s(t,r)}(t,[{key:"subscribe",value:function(t,e){var r=this.observers;P(r[t])&&Object.defineProperty(r,t,{value:[]}),r[t].push(e)}},{key:"unsubscribe",value:function(e){this.observers=this.observers.filter(function(t){return t!==e})}},{key:"notify",value:function(e,r,n){P(this.observers[e])||this.observers[e].forEach(function(t){if(r!==t)switch(e){case"onmove":t.onMove(n);break;case"onrotate":t.onRotate(n);break;case"onresize":t.onResize(n);break;case"onapply":t.onApply(n);break;case"onrefreshstate":t.onRefreshState(n)}})}}]),t}();function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var h=function(){function i(t){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),!t)return this;if("string"==typeof t){var e=document.querySelectorAll(t);this.length=e.length;for(var r=0;r<this.length;r++)this[r]=e[r]}else if(1===t.nodeType||t===document)this[0]=t,this.length=1;else if(t instanceof Subjx||"object"===l(t)){this.length=t.length;for(var n=0;n<this.length;n++)this[n]=t[n]}else if(Array.isArray(t))for(var o=this.length=0;o<this.length;o++)1===t.nodeType&&(this[o]=t[o],this.length++);return this}return function(t,e,r){e&&u(t.prototype,e),r&&u(t,r)}(i,[{key:"css",value:function(t){return function(r){var t={setStyle:function(t){return function(t,e){var r=t.length;for(;r--;)for(var n in e)t[r].style[n]=e[n];return t.style}(this,t)},getStyle:function(){return function(t){var e=t.length;for(;e--;){if(t[e].currentStyle)return t[e].currentStyle[r];if(document.defaultView&&document.defaultView.getComputedStyle){if(r.includes("transform")){return document.defaultView.getComputedStyle(t[e],"")[r].replace(/-?1.22465e-16/g,"0").replace(/6.12323e-17/g,"0")}return document.defaultView.getComputedStyle(t[e],"")[r]}return t[e].style[r]}}(this)}};{if("string"==typeof r)return t.getStyle.apply(this,o.call(arguments,1));if("object"===l(r)||!r)return t.setStyle.apply(this,arguments);a("Method ".concat(r," does not exist"))}return!1}.call(this,t)}},{key:"find",value:function(t){return function(t){var e=this.length;for(;e--;)return j(this[e].querySelectorAll(t))}.call(this,t)}},{key:"each",value:function(t){return function(t){for(var e=o.call(this,0),r=e.length-1;0<=r;--r)n=r,t.call(e[n]);var n;return this}.call(this,t)}},{key:"on",value:function(){return function(){var t=this.length;for(;t--;)this[t].events||(this[t].events={},this[t].events[arguments[0]]=[]),2===arguments.length?document.addEventListener?this[t].addEventListener(arguments[0],arguments[1],!1):document.attachEvent?this[t].attachEvent("on".concat(arguments[0]),arguments[1]):this[t]["on".concat(arguments[0])]=arguments[1]:3===arguments.length&&"string"==typeof arguments[1]&&d(this[t],arguments[0],arguments[1],arguments[2],!0);return this}.apply(this,arguments)}},{key:"off",value:function(){return function(){var t=this.length;for(;t--;)this[t].events||(this[t].events={},this[t].events[arguments[0]]=[]),2===arguments.length?document.removeEventListener?this[t].removeEventListener(arguments[0],arguments[1],!1):document.detachEvent?this[t].detachEvent("on".concat(arguments[0]),arguments[1]):this[t]["on".concat(arguments[0])]=null:3===arguments.length&&"string"==typeof arguments[1]&&d(this[t],arguments[0],arguments[1],arguments[2],!1);return this}.apply(this,arguments)}},{key:"is",value:function(t){return function(t){var e=j(t),r=this.length;for(;r--;)if(this[r]===e[r])return!0;return!1}.call(this,t)}}]),i}();function d(t,e,r,n,o){function i(t){for(var e=t.target;e&&e!==this;)e.matches(r)&&n.call(e,t),e=e.parentNode}!0===o?document.addEventListener?t.addEventListener(e,i,!1):document.attachEvent?t.attachEvent("on".concat(e),i):t["on".concat(e)]=i:document.removeEventListener?t.removeEventListener(e,i,!1):document.detachEvent?t.detachEvent("on".concat(e),i):t["on".concat(e)]=null}function j(t){return new h(t)}function E(t){return t.getBoundingClientRect()}function k(t){return t.css("-webkit-transform")||t.css("-moz-transform")||t.css("-ms-transform")||t.css("-o-transform")||t.css("transform")||"none"}function C(t){var e={};for(var r in t=t.match(/(\w+\((\-?\d+\.?\d*e?\-?\d*(?:,|\s)?)+\))+/g)){var n=t[r].match(/[\w\.\-]+/g);e[n.shift()]=n.map(function(t){return Number(t)})}return e}function O(t){var e=k(t).match(/-?\d+\.?\d+|-?\d+/g);return e?e.map(function(t){return parseFloat(t)}):[1,0,0,1,0,0]}function M(e,t){if(t){if(e.classList){if(!(-1<t.indexOf(" ")))return e.classList.add(t);t.split(/\s+/).forEach(function(t){return e.classList.add(t)})}return e}}var p=/px|em|%|ex|ch|rem|vh|vw|vmin|vmax|mm|cm|in|pt|pc|deg/,g=Math.PI/180,ft=180/Math.PI;function Qt(t){var e=t.x,r=t.y,n=t.centerX,o=t.centerY,i=t.angle,a=t.newCenterX,s=t.newCenterY,c=z(n,o,e,r,i,!1,!1),l=z(a,s,e,r,i,!1,!1),u=e-(c.left-l.left),h=r-(c.top-l.top);return{resX:b(u),resY:b(h)}}function D(t,e){if(0===e)return t;var r=T(t,e);return r-t<e?r:void 0}function T(t,e){return 0===e?t:e*Math.round(t/e)}function L(t,e,r,n,o,i,a){var s=t+parseFloat(r)/2,c=e+parseFloat(n)/2,l=t-s,u=e-c,h=Math.atan2(u,l)+o,f=Math.sqrt(Math.pow(parseFloat(r)/2,2)+Math.pow(parseFloat(n)/2,2)),d=Math.cos(h),p=Math.sin(h),g=c+f*(p=!0===a?-p:p);return{left:b(s+f*(d=!0===i?-d:d)),top:b(g)}}function z(t,e,r,n,o,i,a){var s=Math.cos(o),c=Math.sin(o),l=(s=!0===i?-s:s)*(n-e)-(c=!0===a?-c:c)*(r-t)+e;return{left:b(s*(r-t)+c*(n-e)+t),top:b(l)}}function R(t,e){return/px/.test(t)?t:/%/.test(t)?"".concat(parseFloat(t)*parseFloat(e)/100,"px"):void 0}function B(t,e,r){return/px/.test(r)?t:/%/.test(r)?"".concat(100*parseFloat(t)/parseFloat(e),"%"):void 0}function q(t){return t.match(p)[0]}function b(t){return Number(t.toFixed(6))}function y(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var v=function(){function r(t,e){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),this.constructor===r)throw new TypeError("Cannot construct Subject instances directly");this.el=t,this.storage=null,this.Ob=e,this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onTouchMove=this._onTouchMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this)}return function(t,e,r){e&&y(t.prototype,e),r&&y(t,r)}(r,[{key:"enable",value:function(t){P(this.storage)?(this._load(t),this._init(this.el)):warn("Already enabled")}},{key:"disable",value:function(){var t=this.storage,e=this.el;P(t)||(function(e,t){if(t){if(e.classList){if(!(-1<t.indexOf(" ")))return e.classList.remove(t);t.split(/\s+/).forEach(function(t){return e.classList.remove(t)})}}}(e,"dg-drag"),this._destroy(),delete this.storage)}},{key:"_load",value:function(t){(function(e){M(this.el,"dg-drag");var t={x:10,y:10,angle:10*g},r={move:!1,resize:!1,rotate:!1};if(f(e)){if(f(e.snap)){var n=e.snap,o=n.x,i=n.y,a=n.angle;t.x=P(o)?10:o,t.y=P(i)?10:i,t.angle=P(a)?1*g:a*g}if(f(e.each)){var s=e.each,c=s.move,l=s.resize,u=s.rotate;r.move=c||!1,r.resize=l||!1,r.rotate=u||!1}}var h=this.Ob;(r.move||r.resize||r.rotate)&&(h.subscribe("onrefreshstate",this),h.subscribe("onapply",this));r.move&&h.subscribe("onmove",this);r.resize&&h.subscribe("onresize",this);r.rotate&&h.subscribe("onrotate",this);this.storage={drop:e&&function(t){return"function"==typeof t}(e.drop)?function(t){e.drop(t,this.el)}:function(){},snap:t,each:r}}).call(this,t)}},{key:"_draw",value:function(){var T=this;!function t(){var e=T.storage;if(e.frame=N(t),e.doDraw){e.doDraw=!1;var r=e.handle,n=e.handles,o=e.cx,i=e.cy,a=e.ch,s=e.cw,c=e.refang,l=e.pressang,u=e.pageX,h=e.pageY,f=e.center,d=(e.snap,e.parentScale),p=e.doDrag,g=e.doResize,b=e.doRotate,y=d[0],v=d[1],m=e.each,w=m.move,x=(m.resize,m.rotate);if(g){var k,M,X,Y,S,_=null,A=null;if(r.is(n.br)||r.is(n.mr))Y=((h=(S=z(o,i,u,h,c,!1,!1)).top)-i)/v,X=((u=S.left)-o)/y,r.is(n.br)&&(A=Y+a),_=X+s,M=k=!1;else if(r.is(n.tl)||r.is(n.ml))Y=-((h=(S=z(o,i,u,h,c,!1,!1)).top)-i)/v,_=(X=-((u=S.left)-o)/y)+s,r.is(n.tl)&&(A=Y+a),M=k=!0;else if(r.is(n.tr)||r.is(n.tc)){var E=r.is(n.tr),O=r.is(n.tc);Y=-((h=(S=z(o,i,u,h,c,E,!1)).top)-i)/v,X=-((u=S.left)-o)/y,E&&(Y=-Y),A=Y+a,E&&(_=X+s),k=O,M=!0}else if(r.is(n.bl)||r.is(n.bc)){var P=r.is(n.bl);h=(S=z(o,i,u,h,c,!1,P)).top,X=-((u=S.left)-o)/y,A=(Y=(h-i)/v)+a,P&&(_=X+s),k=P,M=!1}T._resize(_,A,k,M,X,Y)}if(p){var j=(h-i)/v,C=(u-o)/y;T._drag(j,C),w&&T.Ob.notify("onmove",T,{diffTop:j,diffLeft:C})}if(b){var D=Math.atan2(h-f.y,u-f.x)-l;T._rotate(D),x&&T.Ob.notify("onrotate",T,{radians:D})}}}()}},{key:"_start",value:function(t){t.stopImmediatePropagation&&t.stopImmediatePropagation();var e=this.storage,r=this._compute(t);e.pageX=t.pageX,e.pageY=t.pageY,e.cx=t.pageX,e.cy=t.pageY,e.ctrlKey=t.ctrlKey,e.shiftKey=t.shiftKey,Object.keys(r).forEach(function(t){e[t]=r[t]});var n=r.onRightEdge,o=r.onBottomEdge,i=r.onTopEdge,a=r.onLeftEdge,s=r.handle,c=r.factor,l=r.revX,u=r.revY,h=n||o||i||a,f=s.is(e.handles.rotator);e.doResize=h,e.doDrag=!f&&!h,e.doRotate=f,this.Ob&&this.Ob.notify("onrefreshstate",this,{factor:c,revX:l,revY:u,onTopEdge:i,onLeftEdge:a,onRightEdge:n,onBottomEdge:o}),this._draw()}},{key:"_moving",value:function(t){t.preventDefault&&t.preventDefault();var e=this.storage;e.pageX=t.pageX,e.pageY=t.pageY,e.doDraw=!0}},{key:"_end",value:function(t){t.stopImmediatePropagation&&t.stopImmediatePropagation();var e=this.storage,r=e.doResize?"resize":e.doDrag?"drag":"rotate";e.doResize=!1,e.doDrag=!1,e.doRotate=!1,e.doDraw=!1,this._apply(r),this.Ob&&this.Ob.notify("onapply",this,r),n(e.frame),e.drop.call(this,t)}},{key:"_onMouseDown",value:function(t){this._start(t),j(document).on("mousemove",this._onMouseMove).on("mouseup",this._onMouseUp)}},{key:"_onTouchStart",value:function(t){this._start(t.touches[0]),j(document).on("touchmove",this._onTouchMove).on("touchend",this._onTouchEnd)}},{key:"_onMouseMove",value:function(t){this._moving(t,this.el)}},{key:"_onTouchMove",value:function(t){this._moving(t.touches[0],this.el)}},{key:"_onMouseUp",value:function(t){!function(t){Object.values(t).forEach(function(t){t&&(t.style.display="none")})}(this.storage.guidlines),this._end(t,this.el),j(document).off("mousemove",this._onMouseMove).off("mouseup",this._onMouseUp)}},{key:"_onTouchEnd",value:function(t){0===t.touches.length&&this._end(t.changedTouches[0],this.el),j(document).off("touchmove",this._onTouchMove).off("touchend",this._onTouchEnd)}},{key:"onMove",value:function(t){this._drag(t.diffTop,t.diffLeft)}},{key:"onRotate",value:function(t){this._rotate(t.radians)}},{key:"onResize",value:function(t){var e=null!==t.width?this.storage.cw+t.x:null,r=null!==t.height?this.storage.ch+t.y:null;this._resize(e,r,t.revX,t.revY)}},{key:"onApply",value:function(t){this._apply(t)}}]),r}();function x(t,e,r){var n=e.x-t.x,o=e.y-t.y,i=Math.sqrt(n*n+o*o);return Y(t,e,Math.min(1,r/i))}function X(t){return{x:parseFloat(t[t.length-2]),y:parseFloat(t[t.length-1])}}function Y(t,e,r){return{x:t.x+(e.x-t.x)*r,y:t.y+(e.y-t.y)*r}}function S(t,e){2<t.length&&(t[t.length-2]=e.x,t[t.length-1]=e.y)}function F(t,e,r){var n=2<arguments.length&&void 0!==r&&r,o=function(t){return t.reduce(function(t,e){return parseFloat(e)==e&&t.length?t[t.length-1].push(e):t.push([e]),t},[])}(function(t){return t.split(/[,\s]/).reduce(function(t,e){var r=e.match("([a-zA-Z])(.+)");return r?(t.push(r[1]),t.push(r[2])):t.push(e),t},[])}(t)),i=[];if(1<o.length){var a=X(o[0]),s=null;"Z"===o[o.length-1][0]&&2<o[0].length&&(s=["L",a.x,a.y],o[o.length-1]=s),i.push(o[0]);for(var c=1;c<o.length;c++){var l=i[i.length-1],u=o[c],h=u===s?o[1]:o[c+1];if(h&&l&&2<l.length&&"L"===u[0]&&2<h.length&&"L"===h[0]){var f=X(l),d=X(u),p=X(h),g=void 0,b=void 0;b=n?(g=Y(d,l.origPoint||f,e),Y(d,h.origPoint||p,e)):(g=x(d,f,e),x(d,p,e)),S(u,g),u.origPoint=d,i.push(u);var y=Y(g,d,.5),v=Y(d,b,.5),m=["C",y.x,y.y,v.x,v.y,b.x,b.y];m.origPoint=d,i.push(m)}else i.push(u)}if(s){var w=X(i[i.length-1]);i.push(["Z"]),S(i[0],w)}}else i=o;return i.reduce(function(t,e){return t+e.join(" ")+" "},"")}function m(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function w(t){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function I(t){return function(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function _(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function A(t,e){return!e||"object"!==w(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function H(t){return(H=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function V(t,e){return(V=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var W={stopDragX:!1,tempPositionX:0,stopDragY:!1,tempPositionY:0,normalizeX:0,normalizeY:0,newPositionX:0,newPositionY:0},U=function(){function o(t,e,r){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),window.parent.addEventListener("message",$),(n=A(this,H(o).call(this,t,r))).enable(e),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&V(t,e)}(o,v),function(t,e,r){e&&_(t.prototype,e),r&&_(t,r)}(o,[{key:"_init",value:function(t,e){(function(t){var e=document.createElement("div");M(e,"dg-wrapper"),t.parentNode.insertBefore(e,t);var r=e,n=j(t),o=n.css("width"),i=n.css("height"),a=n.css("top"),s=n.css("left"),c=j(r.parentNode),l={top:a,left:s,width:R(o,c.css("width")),height:R(i,c.css("height")),transform:k(n)},u=document.createElement("div"),h={centerX:document.querySelector(".guid-line.guid-line-y.guid-center-y"),centerY:document.querySelector(".guid-line.guid-line-x.guid-center-x"),left:document.querySelector(".guid-line.guid-line-y.guid-left"),right:document.querySelector(".guid-line.guid-line-y.guid-right"),top:document.querySelector(".guid-line.guid-line-x.guid-top"),bottom:document.querySelector(".guid-line.guid-line-x.guid-bottom")},f=document.querySelector(".dg-wrapper + .drag-item-content");f=f||document.querySelector(".drag-item-content");K=!!+f.dataset.locked;var d,p,g=f.getBoundingClientRect();d=[].map.call(document.querySelectorAll(".drag-item-content"),function(t){if(f!==t){var e=t.getBoundingClientRect();return{left:e.left,top:e.top,right:e.right,bottom:e.bottom,centerX:e.left+e.width/2,centerY:e.top+e.height/2}}}).filter(function(t){return t}),p={left:g.left,top:g.top,right:g.right,bottom:g.bottom,centerX:g.left+g.width/2,centerY:g.top+g.height/2};var b=document.body.clientWidth/2,y=document.body.clientHeight/2;u.innerHTML='<div class="dg-hdl dg-rotator"></div>        <div class="dg-hdl dg-hdl-t dg-hdl-l dg-hdl-tl"></div>        <div class="dg-hdl dg-hdl-t dg-hdl-r dg-hdl-tr"></div>        <div class="dg-hdl dg-hdl-b dg-hdl-r dg-hdl-br"></div>        <div class="dg-hdl dg-hdl-b dg-hdl-l dg-hdl-bl"></div>        <div class="dg-hdl dg-hdl-t dg-hdl-c dg-hdl-tc"></div>        <div class="dg-hdl dg-hdl-b dg-hdl-c dg-hdl-bc"></div>        <div class="dg-hdl dg-hdl-m dg-hdl-l dg-hdl-ml"></div>        <div class="dg-hdl dg-hdl-m dg-hdl-r dg-hdl-mr"></div>',M(u,"dg-controls"),r.appendChild(u);var v=j(u);v.css(l);var m=j(r),w=f.querySelector("svg"),x=f.querySelector("svg path");Q=+f.dataset.round,G="1"===f.dataset.rect,Object.assign(this.storage,{controls:u,guidlines:h,coordinates:d,screenCenterX:b,screenCenterY:y,verticalCoordinates:nt(d,b,"left"),horizontalCoordinates:nt(d,y,"top"),activeElementCoordinates:p,activeElement:f,handles:{tl:m.find(".dg-hdl-tl"),tr:m.find(".dg-hdl-tr"),br:m.find(".dg-hdl-br"),bl:m.find(".dg-hdl-bl"),tc:m.find(".dg-hdl-tc"),bc:m.find(".dg-hdl-bc"),ml:m.find(".dg-hdl-ml"),mr:m.find(".dg-hdl-mr"),rotator:m.find(".dg-rotator")},svg:w,svgPath:x,parent:c}),v.on("mousedown",this._onMouseDown).on("touchstart",this._onTouchStart),n[0].querySelector(".text-container")&&(m.find(".dg-hdl-bc")[0].style.display="none",m.find(".dg-hdl-tc")[0].style.display="none")}).call(this,t,e)}},{key:"_destroy",value:function(t){(function(){window.parent.removeEventListener(handleLayerLock);var t=this.storage.controls;j(t).off("mousedown",this._onMouseDown).off("touchstart",this._onTouchStart),this.el.parentNode.removeChild(t.parentNode)}).call(this,t)}},{key:"_drag",value:function(){et.call.apply(et,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"_rotate",value:function(){it.call.apply(it,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"_resize",value:function(){tt.call.apply(tt,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"_compute",value:function(){return J.call.apply(J,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"_apply",value:function(){window.parent.postMessage({event:"apply-from-iframe"},"http://127.0.0.1:3978/#/edit");var t=this.storage,e=this.el,r=j(e),n=t.cached,o=t.parent,i=t.dimens,a=t.handle,s=t.controls;if(n){var c=I(n),l=c[4],u=c[5],h=at(c),f=o.css("width"),d=o.css("height"),p=parseFloat(R(r.css("left"),f)),g=parseFloat(R(r.css("top"),d));h.left=B(p+l+"px",f,i.left),h.top=B(g+u+"px",d,i.top);var b=e.querySelector(".text-container"),y=a[0].classList.contains("dg-controls")||!b||!a[0].classList.contains("dg-hdl-ml")&&!a[0].classList.contains("dg-hdl-mr");window.parent.postMessage({event:"resize-on-mouseup",position:{width:s.style.width,height:s.style.height,diffLeft:l,diffTop:u},isTextDrag:y},"http://127.0.0.1:3978/#/edit"),this.storage.cached=null}}},{key:"onRefreshState",value:function(t){var e=this.storage,r=function(t,e,r){var n=this.storage,o=n.controls,i=n.handles,a=n.parent,s=n.snap,c=E(i.tl[0]),l=E(i.tr[0]),u=Math.atan2(l.top-c.top,l.left-c.left)*t,h=parseFloat(R(o.style.width,a.css("width"))),f=parseFloat(R(o.style.height,a.css("height"))),d=O(j(o)),p=L(d[4],d[5],h,f,u,e,r),g=j(this.el),b=this.el.style;return{transform:d,parentTransform:O(a),left:T(d[4],s.x),top:T(d[5],s.y),coordX:p.left,coordY:p.top,refang:u,cw:h,ch:f,dimens:{top:q(b.top||g.css("top")),left:q(b.left||g.css("left")),width:q(b.width||g.css("width")),height:q(b.height||g.css("height"))}}}.call(this,t.factor,t.revX,t.revY);Object.keys(r).forEach(function(t){e[t]=r[t]})}}]),o}(),Z=!0,K=!1,Q=0,G=!1;function $(t){"set-lock-settings"===t.data.event?Z=t.data.locked:"lock-layer"===t.data.event?K=t.data.locked:"set-shape-round-value"===t.data.event?Q=t.data.round:"select-shape"===t.data.event?G=t.data.rect:"срфтпу-thickness"===t.data.event&&t.data.thickness}function J(t){W.stopDragX=!1,W.stopDragY=!1,W.tempPositionX=0,W.tempPositionY=0,W.normalizeX=0,W.newPositionX=0,W.newPositionY=0,W.tempPositionX=0,W.tempPositionY=0,window.parent.postMessage({event:"compute-from-iframe"},"http://127.0.0.1:3978/#/edit");var e=this.el,r=this.storage,n=r.handles,o=r.controls,i=r.parent,a=r.snap,s=j(t.target),c=e.querySelector(".text-container"),l=s[0].classList.contains("dg-hdl-ml"),u=s[0].classList.contains("dg-hdl-mr");!c||l||u||(c.style.width="".concat(e.clientWidth,"px"));var h=1,f=s.is(n.tl)||s.is(n.ml)||s.is(n.bl)||s.is(n.tc),d=s.is(n.tl)||s.is(n.tr)||s.is(n.tc)||s.is(n.ml);(s.is(n.tr)||s.is(n.bl))&&(h=-1);var p=E(n.tl[0]),g=E(n.tr[0]),b=Math.atan2(g.top-p.top,g.left-p.left)*h,y=parseFloat(R(o.style.width,i.css("width"))),v=parseFloat(R(o.style.height,i.css("height"))),m=O(j(o)),w=L(m[4],m[5],y,v,b,f,d),x=E(o),k=x.left+y/2,M=x.top+v/2,X=Math.atan2(t.pageY-M,t.pageX-k),Y=j(e),S=e.style,_={top:q(S.top||Y.css("top")),left:q(S.left||Y.css("left")),width:q(S.width||Y.css("width")),height:q(S.height||Y.css("height"))},A=O(i);return{parentScale:[A[0],A[3]],transform:m,cw:y,ch:v,center:{x:k,y:M},left:T(m[4],a.x),top:T(m[5],a.y),coordY:w.top,coordX:w.left,factor:h,pressang:X,refang:b,revX:f,revY:d,handle:s,onTopEdge:s.is(n.tl)||s.is(n.tc)||s.is(n.tr),onLeftEdge:s.is(n.tl)||s.is(n.ml)||s.is(n.bl),onRightEdge:s.is(n.tr)||s.is(n.mr)||s.is(n.br),onBottomEdge:s.is(n.br)||s.is(n.bc)||s.is(n.bl),dimens:_}}function tt(t,e,r,n){if(!K){var o=this.el,i=this.storage,a=i.controls,s=i.handle,c=i.snap,l=i.left,u=i.top,h=i.coordX,f=i.coordY,d=i.refang,p=i.dimens,g=i.parent,b=i.transform,y=i.svg,v=i.svgPath,m=a.style;null!==t&&(m.width="".concat(D(t,c.x),"px"));var w=s[0].classList.contains("dg-hdl-br")||s[0].classList.contains("dg-hdl-tr")||s[0].classList.contains("dg-hdl-bl")||s[0].classList.contains("dg-hdl-tl"),x=!1,k=o.querySelector(".text-container");k&&w&&(x=!0);var M=i.ch/i.cw;if(null!==e&&((!i.shiftKey&&Z||x)&&w&&(e=t*M),m.height="".concat(D(e,c.y),"px")),k&&(s[0].classList.contains("dg-hdl-mr")||s[0].classList.contains("dg-hdl-ml"))){var X=0;[].forEach.call(k.querySelectorAll(".simple-text-line"),function(t){X+=t.clientHeight||t.offsetHeight}),m.height="".concat(D(X||k.parentNode.clientHeight,c.y),"px")}var Y=L(l,u,m.width,m.height,d,r,n),S=u-(Y.top-f),_=l-(Y.left-h),A=I(b);x&&(k.style.transformOrigin="top left",k.style.transform="scale(".concat(parseFloat(m.width)/i.cw,")")),A[4]=_,A[5]=S;var E=at(A);j(a).css(E),E.width=B(m.width,g.css("width"),p.width),E.height=B(m.height,g.css("height"),p.height);var O={width:E.width,height:E.height};j(o).css(E),G&&function(t,e,r,n){t.setAttribute("viewBox","0 0 ".concat(r," ").concat(n));var o="M0 0 L ".concat(r," 0 L").concat(r," ").concat(n," L 0 ").concat(n," Z"),i=+Q;(+r/2<i||+n/2<i)&&(i=+r<+n?+r/2:+n/2);e.setAttribute("d",F(o,i))}(y,v,o.clientWidth,o.clientHeight),window.parent.postMessage({event:"resize-from-package",size:O,isText:x},"http://127.0.0.1:3978/#/edit"),i.cached=A}}function et(t,e){if(!K){var r=this.el,n=this.storage,o=n.controls,i=n.transform,a=n.snap,s=I(i),c={elDrag:r,elDragContainer:document.querySelector("body")};if(c.elDrag.name&&c.elDrag.name.match("fullscreen"))c.elDragClient={left:Math.floor(+c.elDrag.name.split("/")[1]),right:Math.floor(+c.elDrag.name.split("/")[2]),top:Math.floor(+c.elDrag.name.split("/")[3]),bottom:Math.floor(+c.elDrag.name.split("/")[4])},(c.elDragClient.left||Math.abs(Math.floor(c.elDragClient.right+2))-Math.floor(c.elDragContainer.clientWidth))&&(0<e&&c.elDragClient.left?Math.abs(c.elDragClient.left)>Math.abs(e)?s[4]=D(i[4]+Math.floor(e),a.x):s[4]=D(i[4]+Math.abs(c.elDragClient.left),a.x):e<=0&&Math.floor(c.elDragClient.right-2)-Math.floor(c.elDragContainer.clientWidth)&&(0<Math.abs(Math.floor(c.elDragClient.right))-Math.floor(c.elDragContainer.clientWidth)-Math.abs(e)?s[4]=D(i[4]+e,a.x):s[4]=D(i[4]-(Math.abs(Math.floor(c.elDragClient.right))-Math.floor(c.elDragContainer.clientWidth)),a.x))),c.elDragClient.top&&(0<t&&c.elDragClient.top?Math.abs(c.elDragClient.top)>Math.abs(t)?s[5]=D(i[5]+Math.floor(t),a.y):s[5]=D(i[5]+Math.abs(c.elDragClient.top),a.y):e<=0&&Math.floor(c.elDragClient.bottom-2)-Math.floor(c.elDragContainer.clientHeight)&&(0<Math.abs(Math.floor(c.elDragClient.bottom))-Math.floor(c.elDragContainer.clientHeight)-Math.abs(t)?s[5]=D(i[5]+t,a.y):s[5]=D(i[5]-(Math.abs(Math.floor(c.elDragClient.bottom))-Math.floor(c.elDragContainer.clientHeight)),a.y)));else{var l=n.activeElement.getBoundingClientRect(),u={left:l.left,top:l.top,right:l.right,bottom:l.bottom,centerX:l.left+l.width/2,centerY:l.top+l.height/2};s[4]=D(i[4]+ot(n,e,u,"left"),a.x),s[5]=D(i[5]+ot(n,t,u,"top"),a.y)}var h=at(s);j(o).css(h),j(r).css(h),n.cached=s}}function rt(t,e,r){return null==r&&(r=5),Array.from(t).find(function(t){return Math.abs(t-e)<r})}function nt(t,e,n){var o=[e];return t.map(function(t){var e,r;o="left"===n?o.concat(Object.values({left:(r=t).left,right:r.right,centerX:r.centerX})):o.concat(Object.values({top:(e=t).top,bottom:e.bottom,centerY:e.centerY}))}),o}function ot(t,e,r,n){for(var o,i,a=function(t,e){for(var r={left:!1,centerX:!1,right:!1,top:!1,centerY:!1,bottom:!1},n={},o=[],i=[],a={leftSide:rt(t,e.left),centerElementSideX:rt(t,e.centerX),rightSide:rt(t,e.right),topSide:rt(t,e.top),bottomSide:rt(t,e.bottom),centerElementSideY:rt(t,e.centerY)},s=0,c=Object.entries(a);s<c.length;s++){var l=m(c[s],2),u=l[0];if(l[1])switch(u){case"leftSide":n.left=a.leftSide,r.left=!0,o.push(+a.leftSide-+e.left);break;case"centerElementSideX":n.centerX=a.centerElementSideX,r.centerX=!0,o.push(+a.centerElementSideX-+e.centerX);break;case"rightSide":n.right=a.rightSide,r.right=!0,o.push(+a.rightSide-+e.right);break;case"topSide":n.top=a.topSide,r.top=!0,i.push(+a.topSide-+e.top);break;case"centerElementSideY":n.centerY=a.centerElementSideY,r.centerY=!0,i.push(+a.centerElementSideY-+e.centerY);break;case"bottomSide":n.bottom=a.bottomSide,r.bottom=!0,i.push(+a.bottomSide-+e.bottom)}}return{config:r,coorditates:n,diffX:o.length?Math.min.apply(null,o):10,diffY:i.length?Math.min.apply(null,i):10}}("left"===n?t.verticalCoordinates:t.horizontalCoordinates,r),s="left"===n?{left:(i=a.coorditates).left,right:i.right,centerX:i.centerX}:{top:(o=a.coorditates).top,bottom:o.bottom,centerY:o.centerY},c="left"===n?function(t,e,r){W.normalizeX=W.newPositionX-r,W.newPositionX=r;for(var n=0,o=Object.entries(t);n<o.length;n++){var i=m(o[n],2);i[0];!i[1]||W.stopDragX||W.tempPositionX||W.stopDragX?5<=Math.abs(W.newPositionX-W.tempPositionX)&&W.stopDragX&&(W.stopDragX=!1,W.normalizeX=0,W.tempPositionX=0):(W.stopDragX=!0,W.newPositionX+=e+W.normalizeX,W.tempPositionX=W.newPositionX)}return W.stopDragX?W.tempPositionX:W.newPositionX}(s,a.diffX,e):function(t,e,r){W.normalizeY=W.newPositionY-r,W.newPositionY=r;for(var n=0,o=Object.entries(t);n<o.length;n++){var i=m(o[n],2);i[0];!i[1]||W.stopDragY||W.tempPositionY?5<=Math.abs(W.newPositionY-W.tempPositionY)&&W.stopDragY&&(W.stopDragY=!1,W.normalizeY=0,W.tempPositionY=0):(W.stopDragY=!0,W.newPositionY+=e+W.normalizeY,W.tempPositionY=W.newPositionY)}return W.stopDragY?W.tempPositionY:W.newPositionY}(s,a.diffY,e),l=0,u=Object.entries(s);l<u.length;l++){var h=m(u[l],2),f=h[0],d=h[1];d&&Math.abs(d-r[f])<2.5?(t.guidlines[f].style.display="block",t.guidlines[f].style[n]="".concat(parseInt(d),"px"),t.guidlines[f].style["left"===n?"borderLeft":"borderTop"]=d===t.screenCenterY||d===t.screenCenterX?"1.5px solid rgba(51, 122, 255, 0.51)":"1.5px dotted rgba(51, 122, 255, 0.51)"):t.guidlines[f].style.display="none"}return c}function it(t){if(!K){var e=this.el,r=this.storage,n=r.controls,o=r.transform,i=r.refang,a=r.snap,s=I(o),c=D(i+t,a.angle);s[0]=b(Math.cos(c)),s[1]=b(Math.sin(c)),s[2]=-b(Math.sin(c)),s[3]=b(Math.cos(c)),window.parent.postMessage({event:"rotate-from-resizer",value:c*(180/Math.PI)},"http://127.0.0.1:3978/#/edit");var l=at(s);j(n).css(l),j(e).css(l),r.cached=s}}function at(t){var e="matrix(".concat(t.join(),")");return{transform:e,webkitTranform:e,mozTransform:e,msTransform:e,otransform:e}}function Gt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),n.forEach(function(t){st(e,t,r[t])})}return e}function st(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $t(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var ct=/([achlmqstvz])([^achlmqstvz]*)/gi,lt=/\s*,\s*|\s+/g;function Jt(t){for(var e=ct.lastIndex=0,r=[];e=ct.exec(t);){var n=e[1],o=n.toUpperCase();r.push({relative:n!==o,key:o,cmd:n,value:e[2].trim().split(lt).map(function(t){if(!isNaN(t))return Number(t)})})}return r}function te(t,e,r,n){return t+e*(Math.abs(t-r)/n)}function ee(t,e,r){return t+e*(t/r)}function re(t){return!0===t?-1:1}function dt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),n.forEach(function(t){ut(e,t,r[t])})}return e}function ut(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ht(t){return(ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function gt(t,e){return!e||"object"!==ht(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function bt(t){return(bt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function yt(t,e){return(yt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var vt=25,mt=/[+-]?\d+(\.\d+)?/g,wt=/translate\(.*\)(.*)translate\(.*\)|$/,xt=function(){function o(t,e,r){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(n=gt(this,bt(o).call(this,t,r))).enable(e),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yt(t,e)}(o,v),function(t,e,r){e&&pt(t.prototype,e),r&&pt(t,r)}(o,[{key:"_init",value:function(t,e){(function(t){var r=St("g");t.parentNode.appendChild(r);var e=t.getBBox(),n=e.width,o=e.height,i=e.x,a=e.y,s=t.getAttribute("transform")||"translate(0 0)",c=St("rect");[["width",n],["height",o],["x",i],["y",a],["fill","transparent"],["stroke","#00a8ff"],["stroke-dasharray","3 3"],["transform",s]].forEach(function(t){c.setAttribute(t[0],t[1])});var l=St("g");l.appendChild(c),r.appendChild(l);var u={tl:[i,a],tr:[i+n,a],br:[i+n,a+o],bl:[i,a+o],tc:[i+n/2,a],bc:[i+n/2,a+o],ml:[i,a+o/2],mr:[i+n,a+o/2],rotator:[i+n/2,a-vt]};Object.keys(u).forEach(function(t){var e=u[t];u[t]=function(t,e,r){var n=St("circle"),o={cx:t,cy:e,r:6,fill:"white",stroke:"#00a8ff",transform:r};return Object.keys(o).map(function(t){n.setAttribute(t,o[t])}),n}(e[0],e[1],s),r.appendChild(St("g").appendChild(u[t]).parentNode)}),Object.assign(this.storage,{wrapper:r,box:c,handles:u,parent:r.parentNode}),j(r).on("mousedown",this._onMouseDown).on("touchstart",this._onTouchStart)}).call(this,t,e)}},{key:"_destroy",value:function(t){(function(){var t=this.storage.wrapper;j(t).off("mousedown",this._onMouseDown).off("touchstart",this._onTouchStart),this.el.parentNode.removeChild(t)}).call(this,t)}},{key:"_drag",value:function(){Xt.call.apply(Xt,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"_rotate",value:function(){Yt.call.apply(Yt,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"_resize",value:function(){Mt.call.apply(Mt,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"_compute",value:function(){return kt.call.apply(kt,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"_apply",value:function(t){var e=this,r=this.storage,n=r.box,o=r.handles,i=r.refang,a=r.factor,s=r.wrapper,c=r.cached,l=r.transform,u=C(s.getAttribute("transform")||"translate(0 0)").translate,h=n.getBBox(),f=h.x,d=h.y,p=h.width,g=h.height,b=u[0],y=u[1],v=f+b,m=d+y,w=v+p/2,x=m+g/2;if("rotate"!==t&&_t(n,o,{x:v,y:m,width:p,height:g,angle:i*a}),"drag"===t){if(0===b&&0===y)return;s.removeAttribute("transform");var k=[];"g"===this.el.tagName.toLowerCase()?(this.el.childNodes.forEach(function(t){1===t.nodeType&&k.push(t)}),this.el.removeAttribute("transform")):k.push(this.el),k.forEach(function(t){!function(e,t){var r=t.x,n=t.y,o=t.angle,i=t.centerX,a=t.centerY,s=[["transform","rotate(".concat(o," ").concat(i," ").concat(a,")")]];switch(e.tagName.toLowerCase()){case"text":case"rect":var c=Number(e.getAttribute("x"))+r,l=Number(e.getAttribute("y"))+n;s.push(["x",c],["y",l]);break;case"circle":case"ellipse":var u=Number(e.getAttribute("cx"))+r,h=Number(e.getAttribute("cy"))+n;s.push(["cx",u],["cy",h]);break;case"line":var f=Number(e.getAttribute("x1"))+r,d=Number(e.getAttribute("y1"))+n,p=Number(e.getAttribute("x2"))+r,g=Number(e.getAttribute("y2"))+n;s.push(["x1",f],["y1",d],["x2",p],["y2",g]);break;case"polygon":case"polyline":var b=At(e.getAttribute("points")).map(function(t){return t[0]=Number(t[0])+r,t[1]=Number(t[1])+n,t.join(" ")}).join(" ");s.push(["points",b]);break;case"path":var y=e.getAttribute("d");s.push(["d",function(t){for(var e=t.path,r=t.x,n=t.y,o=Jt(e),i="",a=!0,s=0,c=o.length;s<c;s++){var l=o[s],u=l.value,h=l.key,f=l.relative;switch(h){case"M":if(f&&!a)break;u[0]=u[0]+r,u[1]=u[1]+n;break;case"A":if(f)break;u[5]=u[5]+r,u[6]=u[6]+n;break;case"C":if(f)break;u[0]=u[0]+r,u[1]=u[1]+n,u[2]=u[2]+r,u[3]=u[3]+n,u[4]=u[4]+r,u[5]=u[5]+n;break;case"H":if(f)break;u[0]=u[0]+r;break;case"V":if(f)break;u[0]=u[0]+n;break;case"L":case"T":if(f)break;u[0]=u[0]+r,u[1]=u[1]+n;break;case"Q":case"S":if(f)break;u[0]=u[0]+r,u[1]=u[1]+n,u[2]=u[2]+r,u[3]=u[3]+n;break;case"Z":u[0]=""}i+=l.cmd+l.value.join(",")+" ",a=!1}return i}({path:y,x:r,y:n})])}s.forEach(function(t){e.setAttribute(t[0],t[1])})}(t,{x:b,y:y,angle:i*a*ft,centerX:w,centerY:x})})}if("resize"===t){if(P(c))return;var M=[],X=c.revX,Y=c.revY,S=c.scaleX,_=c.scaleY,A=c.diffX,E=c.diffY,O=!1;"g"===this.el.tagName.toLowerCase()?(this.el.childNodes.forEach(function(t){1===t.nodeType&&M.push(t)}),O=!0):M.push(this.el),M.forEach(function(t){!function(e,t){var r=t.scaleX,n=t.scaleY,o=t.diffX,i=t.diffY,a=t.revX,s=t.revY,c=t.angle,l=t.centerX,u=t.centerY,h=t.bBox,f=t.store,d=f.onRightEdge,p=f.onLeftEdge,g=f.onTopEdge,b=f.onBottomEdge,y=f.center,v=h.x,m=h.y,w=h.width,x=h.height,k=0,M=0;d&&(k=v);p&&(k=v+w);g&&(M=m+x);b&&(M=m);var X={centerX:y.left,centerY:y.top,newCenterX:l,newCenterY:u,angle:c},Y=[["transform","rotate(".concat(c*ft," ").concat(l," ").concat(u,")")]];switch(e.tagName.toLowerCase()){case"text":var S=Number(e.getAttribute("x")),_=Number(e.getAttribute("y")),A=Qt(dt({x:te(S,o,k,w),y:te(_,i,M,x)},X)),E=A.resX,O=A.resY;Y.push(["x",E+(r<0?w:0)],["y",O+(n<0?x:0)]);break;case"circle":var P=Number(e.getAttribute("r")),j=Number(e.getAttribute("cx")),C=Number(e.getAttribute("cy")),D=P*(Math.abs(r)+Math.abs(n))/2,T=Qt(dt({x:te(j,o,k,w),y:te(C,i,M,x)},X)),N=T.resX,L=T.resY;Y.push(["r",D],["cx",N],["cy",L]);break;case"rect":var z=Number(e.getAttribute("width")),R=Number(e.getAttribute("height")),B=Number(e.getAttribute("x")),q=Number(e.getAttribute("y")),F=Qt(dt({x:te(B,o,k,w),y:te(q,i,M,x)},X)),I=F.resX,H=F.resY,V=z*Math.abs(r),W=R*Math.abs(n);Y.push(["x",I-(r<0?V:0)],["y",H-(n<0?W:0)],["width",V],["height",W]);break;case"ellipse":var U=Number(e.getAttribute("rx")),Z=Number(e.getAttribute("ry")),K=Number(e.getAttribute("cx")),Q=Number(e.getAttribute("cy")),G=Qt(dt({x:te(K,o,k,w),y:te(Q,i,M,x)},X)),$=G.resX,J=G.resY;Y.push(["rx",U*Math.abs(r)],["ry",Z*Math.abs(n)],["cx",$],["cy",J]);break;case"line":var tt=Number(e.getAttribute("x1")),et=Number(e.getAttribute("y1")),rt=Number(e.getAttribute("x2")),nt=Number(e.getAttribute("y2")),ot=Qt(dt({x:te(tt,o,k,w),y:te(et,i,M,x)},X)),it=ot.resX,at=ot.resY,st=Qt(dt({x:te(rt,o,k,w),y:te(nt,i,M,x)},X)),ct=st.resX,lt=st.resY;Y.push(["x1",it],["y1",at],["x2",ct],["y2",lt]);break;case"polygon":case"polyline":var ut=At(e.getAttribute("points")).map(function(t){var e=Qt(dt({x:te(Number(t[0]),o,k,w),y:te(Number(t[1]),i,M,x)},X)),r=e.resX,n=e.resY;return t[0]=r,t[1]=n,t.join(" ")}).join(" ");Y.push(["points",ut]);break;case"path":var ht=e.getAttribute("d");Y.push(["d",function(t){for(var e=t.bBox,r=t.path,n=t.baseData,o=t.dx,i=t.dy,a=t.revX,s=t.revY,c=t.fixedX,l=t.fixedY,u=Jt(r),h=e.width,f=e.height,d="",p=[],g=!0,b=0,y=u.length;b<y;b++){var v=u[b],m=v.value,w=v.key,x=v.relative;switch(w){case"A":var k=$t(m,7),M=k[0],X=k[1],Y=k[2],S=k[3],_=k[4],A=k[5],E=k[6],O=re(a),P=re(s),j=[],C=M+o*O*(M/h),D=X+i*P*(X/f);if(j.push(C,D,Y,S,_),x)j.push(ee(A,o*O,h),ee(E,i*P,f));else{var T=Qt(Gt({x:te(A,o,c,h),y:te(E,i,l,f)},n)),N=T.resX,L=T.resY;j.push(N,L)}p.push(j);break;case"C":var z=$t(m,6),R=z[0],B=z[1],q=z[2],F=z[3],I=z[4],H=z[5];if(x){var V=re(a),W=re(s);p.push([ee(R,o*V,h),ee(B,i*W,f),ee(q,o*V,h),ee(F,i*W,f),ee(I,o*V,h),ee(H,i*W,f)])}else{var U=s&&l<B||!s&&B<l?-1:1,Z=a&&c<q||!a&&q<c?-1:1,K=s&&l<F||!s&&F<l?-1:1,Q=Qt(Gt({x:te(R,o*(a&&c<R||!a&&R<c?-1:1),c,h),y:te(B,i*U,l,f)},n)),G=Q.resX,$=Q.resY,J=Qt(Gt({x:te(q,o*Z,c,h),y:te(F,i*K,l,f)},n)),tt=J.resX,et=J.resY,rt=Qt(Gt({x:te(I,o,c,h),y:te(H,i,l,f)},n)),nt=rt.resX,ot=rt.resY;p.push([G,$,tt,et,nt,ot])}break;case"H":if(x){var it=re(a);p.push([ee(m[0],o*it,h)])}else{var at=Qt(Gt({x:te(m[0],o,c,h),y:0},n)).resX;p.push([at])}break;case"V":if(x){var st=re(s);p.push([ee(m[0],i*st,f)])}else{var ct=Qt(Gt({x:0,y:te(m[0],i,l,f)},n)).resY;p.push([ct])}break;case"T":case"L":if(x){var lt=re(a),ut=re(s);p.push([ee(m[0],o*lt,h),ee(m[1],i*ut,f)])}else{var ht=Qt(Gt({x:te(m[0],o,c,h),y:te(m[1],i,l,f)},n)),ft=ht.resX,dt=ht.resY;p.push([ft,dt])}break;case"M":var pt=$t(m,2),gt=pt[0],bt=pt[1];if(x&&!g){var yt=re(a),vt=re(s);p.push([ee(gt,o*yt,h),ee(bt,i*vt,f)])}else{var mt=Qt(Gt({x:te(gt,o,c,h),y:te(bt,i,l,f)},n)),wt=mt.resX,xt=mt.resY;p.push([wt,xt])}break;case"Q":var kt=$t(m,4),Mt=kt[0],Xt=kt[1],Yt=kt[2],St=kt[3];if(x){var _t=re(a),At=re(s);p.push([ee(Mt,o*_t,h),ee(Xt,i*At,f),ee(Yt,o*_t,h),ee(St,i*At,f)])}else{var Et=s&&l<Xt||!s&&Xt<l?-1:1,Ot=Qt(Gt({x:te(Mt,o*(a&&c<Mt||!a&&Mt<c?-1:1),c,h),y:te(Xt,i*Et,l,f)},n)),Pt=Ot.resX,jt=Ot.resY,Ct=Qt(Gt({x:te(Yt,o,c,h),y:te(St,i,l,f)},n)),Dt=Ct.resX,Tt=Ct.resY;p.push([Pt,jt,Dt,Tt])}break;case"S":var Nt=$t(m,4),Lt=Nt[0],zt=Nt[1],Rt=Nt[2],Bt=Nt[3];if(x){var qt=re(a),Ft=re(s);p.push([ee(Lt,o*qt,h),ee(zt,i*Ft,f),ee(Rt,o*qt,h),ee(Bt,i*Ft,f)])}else{var It=s&&l<zt||!s&&zt<l?-1:1,Ht=Qt(Gt({x:te(Lt,o*(a&&c<Lt||!a&&Lt<c?-1:1),c,h),y:te(zt,i*It,l,f)},n)),Vt=Ht.resX,Wt=Ht.resY,Ut=Qt(Gt({x:te(Rt,o,c,h),y:te(Bt,i,l,f)},n)),Zt=Ut.resX,Kt=Ut.resY;p.push([Vt,Wt,Zt,Kt])}break;case"Z":p.push([""])}d+=v.cmd+p[b].join(",")+" ",g=!1}return d}({bBox:h,path:ht,baseData:X,dx:o,dy:i,revX:a,revY:s,fixedX:k,fixedY:M})])}Y.forEach(function(t){e.setAttribute(t[0],t[1])})}(t,{scaleX:S,scaleY:_,diffX:A*re(X),diffY:E*re(Y),revX:X,revY:Y,angle:i*a,factor:a,centerX:w,centerY:x,bBox:!0===O?l.bBox:t.getBBox(),store:e.storage})}),this.storage.cached=null}}},{key:"onRefreshState",value:function(e){var r=this.storage,n=function(t){var e=t.factor,r=t.revX,n=t.revY,o=this.storage,i=o.box,a=o.handles,s=o.snap,c=E(a.tl),l=E(a.tr),u=Math.atan2(l.y-c.y,l.x-c.x)*e,h=i.getBBox(),f=h.width,d=h.height,p=h.x,g=h.y,b=L(p,g,f,d,u,r,n),y=E(i);return{transform:{orig:this.el.getAttribute("transform"),value:i.getAttribute("transform"),scaleX:r?f+p:p,scaleY:n?d+g:g,bBox:h},cw:f,ch:d,center:{x:y.left+f/2,y:y.top+d/2,left:p+f/2,top:g+d/2},left:T(p,s.x),top:T(g,s.y),coordX:b.left,coordY:b.top,factor:e,refang:u}}.call(this,e);Object.keys(e).forEach(function(t){r[t]=e[t]}),Object.keys(n).forEach(function(t){r[t]=n[t]})}}]),o}();function kt(t){var e=this.storage,r=e.box,n=e.handles,o=e.snap,i=e.parent,a=j(t.target),s=1,c=a.is(n.tl)||a.is(n.ml)||a.is(n.bl)||a.is(n.tc),l=a.is(n.tl)||a.is(n.tr)||a.is(n.tc)||a.is(n.ml);(a.is(n.tr)||a.is(n.bl))&&(s=-1);var u=E(n.tl),h=E(n.tr),f=Math.atan2(h.top-u.top,h.left-u.left)*s,d=r.getBBox(),p=d.width,g=d.height,b=d.x,y=d.y,v=L(b,y,p,g,f,c,l),m=E(r),w=m.left+p/2,x=m.top+g/2,k=Math.atan2(t.pageY-x,t.pageX-w),M=a.is(n.tl)||a.is(n.tc)||a.is(n.tr),X=a.is(n.tl)||a.is(n.ml)||a.is(n.bl),Y=a.is(n.tr)||a.is(n.mr)||a.is(n.br),S=a.is(n.br)||a.is(n.bc)||a.is(n.bl);return{transform:{orig:this.el.getAttribute("transform"),value:r.getAttribute("transform"),scaleX:c?p+b:b,scaleY:l?g+y:y,bBox:d},parentScale:C(i.getAttribute("transform")||"scale(1 1)").scale,cw:p,ch:g,center:{x:m.left+p/2,y:m.top+g/2,left:b+p/2,top:y+g/2},left:T(b,o.x),top:T(y,o.y),coordX:v.left,coordY:v.top,factor:s,pressang:k,refang:f,revX:c,revY:l,handle:a,onTopEdge:M,onLeftEdge:X,onRightEdge:Y,onBottomEdge:S}}function Mt(t,e,r,n){var o=this.storage,i=o.box,a=o.handles,s=o.snap,c=o.left,l=o.top,u=o.coordX,h=o.coordY,f=o.refang,d=o.factor,p=o.cw,g=o.ch,b=o.transform,y=this.el,v=Number(i.getAttribute("width")),m=Number(i.getAttribute("height"));if(null!==t&&(v=D(t,s.x)),null!==e&&(m=D(e,s.y)),!(Math.abs(v)<2||Math.abs(m)<2)){var w=L(c,l,v,m,f,r,n),x=l-(w.top-h);_t(i,a,{x:c-(w.left-u),y:x,width:v,height:m,angle:f*d});var k=v/p,M=m/g;this.storage.cached={scaleX:k,scaleY:M,diffX:v-p,diffY:m-g,revX:r,revY:n};var X=b.scaleX,Y=b.scaleY,S="translate(".concat(X," ").concat(Y,") scale(").concat(k," ").concat(M,") translate(").concat(-X," ").concat(-Y,")");if("g"===y.tagName.toLowerCase())y.childNodes.forEach(function(t){if(1===t.nodeType){var e=t.getAttribute("transform")||"";t.setAttribute("transform",e.replace(wt,S))}});else{var _=y.getAttribute("transform")||"";y.setAttribute("transform",_.replace(wt,S))}}}function Xt(t,e){var r=this.storage,n=r.snap,o=r.transform,i=r.wrapper,a=o.orig||"",s=D(e,n.x),c=D(t,n.y),l="translate(".concat(s," ").concat(c,")"),u=a.replace(/translate\(.+\)|^/,l);i.setAttribute("transform",l),this.el.setAttribute("transform",u)}function Yt(t){var e=this.storage,r=e.refang,n=e.snap,o=e.center,i=e.box,a=e.handles,s=D(r+t,n.angle),c="rotate(".concat(s*ft," ").concat(o.left," ").concat(o.top,")");i.setAttribute("transform",c),Object.keys(a).forEach(function(t){a[t].setAttribute("transform",c)}),"g"===this.el.tagName.toLowerCase()?this.el.childNodes.forEach(function(t){1===t.nodeType&&t.setAttribute("transform",c)}):this.el.setAttribute("transform",c)}function St(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function _t(e,r,t){var n=t.x,o=t.y,i=t.width,a=t.height,s=t.angle,c=i/2,l=a/2,u="rotate(".concat(s*ft," ").concat(n+c," ").concat(o+l,")"),h={tl:[n,o],ml:[n,o+l],bl:[n,o+a],tc:[n+c,o],tr:[n+i,o],mr:[n+i,o+l],br:[n+i,o+a],bc:[n+c,o+a],rotator:[n+c,o-vt+(a<0?a:0)]},f={x:n+=i<0?i:0,y:o+=a<0?a:0,width:Math.abs(i),height:Math.abs(a),transform:u};Object.keys(f).forEach(function(t){e.setAttribute(t,f[t])}),Object.keys(r).forEach(function(t){var e=r[t];e.setAttribute("cx",h[t][0]),e.setAttribute("cy",h[t][1]),e.setAttribute("transform",u)})}function At(t){return t.match(mt).reduce(function(t,e,r,n){return r%2==0&&t.push(n.slice(r,r+2)),t},[])}function Et(t){return(Et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ot(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Pt(t,e){return!e||"object"!==Et(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function jt(t){return(jt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ct(t,e){return(Ct=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}
/* @license
 * Move/Rotate/Resize tool
 * Released under the MIT license, 2018-2019
 * nichollascarter@gmail.com
*/var Dt=function(){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Pt(this,jt(e).call(this,t))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ct(t,e)}(e,h),function(t,e,r){e&&Ot(t.prototype,e),r&&Ot(t,r)}(e,[{key:"drag",value:function(t){return function(e){if(this.length){var r=new c;return i.call(this,function(t){return t instanceof SVGElement?new xt(t,e,r):new U(t,e,r)})}}.call(this,t)}}]),e}();e.default=function(t){return new Dt(t)}}]).default;
//# sourceMappingURL=subjx.js.map